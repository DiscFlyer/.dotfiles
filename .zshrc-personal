######################################################################
#                          ZSH configuration                         #
######################################################################

# Print some system information when the shell is first started
echo $USER@$HOST  $(uname -srm) $(lsb_release -rcs)

# Use micro as default editor
[[ $commands[micro] ]] && export EDITOR=$(which micro)


######################################################################
#                        Additional features                         #
######################################################################

# Use 1password cli and ssh agent
if [[ $commands[op] ]]; then
  eval "$(op completion zsh)"; compdef _op op
  export SSH_AUTH_SOCK=~/.1password/agent.sock
  if [[ -f ~/.config/op/plugins.sh ]]; then
    source ~/.config/op/plugins.sh
    setopt completealiases
  fi
fi

# Use zsh autosuggestions
if [[ -f /home/linuxbrew/.linuxbrew/share/zsh-autosuggestions/zsh-autosuggestions.zsh ]]; then
  source /home/linuxbrew/.linuxbrew/share/zsh-autosuggestions/zsh-autosuggestions.zsh
  ZSH_AUTOSUGGEST_BUFFER_MAX_SIZE=20
  ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=8'
fi

# Use zsh syntax highlighting
if [[ -f /home/linuxbrew/.linuxbrew/share/zsh-fast-syntax-highlighting/fast-syntax-highlighting.plugin.zsh ]]; then
  source /home/linuxbrew/.linuxbrew/share/zsh-fast-syntax-highlighting/fast-syntax-highlighting.plugin.zsh
elif [[ -f /home/linuxbrew/.linuxbrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]]; then
  export ZSH_HIGHLIGHT_HIGHLIGHTERS_DIR=/home/linuxbrew/.linuxbrew/share/zsh-syntax-highlighting/highlighters
  source /home/linuxbrew/.linuxbrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

# Use zsh history substring search
if [[ -f /home/linuxbrew/.linuxbrew/share/zsh-history-substring-search/zsh-history-substring-search.zsh ]]; then
  source /home/linuxbrew/.linuxbrew/share/zsh-history-substring-search/zsh-history-substring-search.zsh
  # bind UP and DOWN arrow keys to history substring search
  bindkey "$terminfo[kcuu1]" history-substring-search-up
  bindkey "$terminfo[kcud1]" history-substring-search-down
  bindkey '^[[A' history-substring-search-up
  bindkey '^[[B' history-substring-search-down
fi


######################################################################
#                              Aliases                               #
######################################################################

# Do not expand these aliases using omz globalias plugin
GLOBALIAS_FILTER_VALUES=(
  cp
  dot
  egrep
  fgrep
  gh
  grep
  lg
  ll
  ls
  lt
  mv
  rm
  which
)

# Load personal aliases
[[ -f ~/.alias-personal ]] && source ~/.alias-personal
[[ -f ~/.functions-personal ]] && source ~/.functions-personal
